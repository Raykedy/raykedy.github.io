<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>2051: Алгоритм Пробуждение</title>
<style>
  html, body {
    height: 100%;
    margin: 0;
    background: #000;
    overflow: hidden;
    font-family: Arial, sans-serif;
  }
  /* Фон-видео на весь экран */
  #bgVideo {
    position: fixed;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
    pointer-events: none;
    background: #000;
  }
  /* Центральный текст */
  .content {
    position: relative;
    z-index: 1;
    color: #fff;
    text-align: center;
    top: 40%;
    padding: 0 16px;
  }
  h1 { margin: 0 0 12px; font-size: 3rem; }
  p  { margin: 0 auto; max-width: 680px; font-size: 1.2rem; opacity: .9; }

  /* Фиксированная верхняя надпись в четыре строки */
  .fixed-line-top {
    position: fixed;
    top: calc(8px + env(safe-area-inset-top));
    left: 50%;
    transform: translateX(-50%);
    z-index: 2;
    color: #ffcc66;
    background: rgba(0,0,0,0.45);
    padding: 8px 16px;
    border-radius: 8px;
    text-align: center;
    max-width: calc(100% - 24px);
    font-size: 1.05rem;
    line-height: 1.3;
    box-shadow: 0 2px 10px rgba(0,0,0,.35);
  }
  .fixed-line-top div { white-space: normal; }

  /* Подсказка снизу (по желанию) */
  .hint {
    position: fixed; left: 50%; bottom: 60px; transform: translateX(-50%);
    color: #bbb; font-size: .95rem; text-align: center;
    z-index: 3; padding: 8px 14px; background: rgba(0,0,0,.4); border-radius: 8px;
    pointer-events: none; opacity: 0; transition: opacity .35s ease;
  }
  .hint.show { opacity: 1; }

  /* Мобильные правки */
  @media (max-width: 600px) {
    h1 { font-size: 2.2rem; }
    .content p { font-size: 1rem; }
    .fixed-line-top { font-size: .95rem; padding: 6px 10px; }
  }
  @media (max-width: 380px) {
    h1 { font-size: 1.9rem; }
    .fixed-line-top { font-size: .9rem; padding: 6px 8px; }
  }
</style>
</head>
<body>

<!-- ВИДЕОФОН (как на твоих скринах) -->
<video id="bgVideo" autoplay muted playsinline loop preload="auto">
  <source src="https://raykedy.github.io/raykedy.github.io/main/motivational-adventure-cinematic-150072(2).mp4" type="video/mp4">
</video>

<!-- МУЗЫКА (raw.githubusercontent, как у тебя было) -->
<audio id="bgMusic" preload="auto" loop>
  <source src="https://raw.githubusercontent.com/Raykedy/raykedy.github.io/main/motivational-adventure-cinematic-150072(2).mp3?v=3" type="audio/mpeg">
</audio>

<!-- Верхняя надпись в 4 строки -->
<div class="fixed-line-top">
  <div>Официальный.</div>
  <div>хаб раздачи.</div>
  <div>Скачать книгу</div>
  <div>можно здесь.</div>
</div>

<!-- Центральный текст -->
<div class="content">
  <h1>2051: Алгоритм Пробуждение</h1>
  <p>Погрузись в мир, где границы между разумом и кодом стираются.</p>
</div>

<div id="hint" class="hint"></div>

<script>
(function () {
  const video = document.getElementById('bgVideo');
  const audio = document.getElementById('bgMusic');
  const hint  = document.getElementById('hint');

  // стартуем без звука, потом плавно нагоним
  audio.volume = 0;

  function showHint(msg) {
    hint.textContent = msg;
    hint.classList.add('show');
    clearTimeout(showHint._t);
    showHint._t = setTimeout(() => hint.classList.remove('show'), 5000);
  }

  function fadeInAudio(targetVol = 1, step = 0.02, interval = 100) {
    let vol = audio.volume;
    const id = setInterval(() => {
      vol = Math.min(targetVol, vol + step);
      audio.volume = vol;
      if (vol >= targetVol) clearInterval(id);
    }, interval);
  }

  // подравниваем музыку под таймкод видео (чтобы не «уплывала»)
  function alignAudioToVideo() {
    if (isFinite(audio.duration) && audio.duration > 0) {
      const target = video.currentTime % audio.duration;
      const cur    = audio.currentTime % audio.duration;
      const drift  = Math.abs(cur - target);
      if (drift > 0.35) audio.currentTime = target;
    }
  }

  let driftTimer = null;
  function startDriftCorrection() {
    if (!driftTimer) driftTimer = setInterval(alignAudioToVideo, 2000);
  }
  function stopDriftCorrection() {
    if (driftTimer) { clearInterval(driftTimer); driftTimer = null; }
  }

  function trySyncStart() {
    alignAudioToVideo();
    audio.play().then(() => {
      fadeInAudio(1, 0.02, 100);
      startDriftCorrection();
    }).catch(() => {
      showHint('Нажми на экран, чтобы включить звук');
    });
  }

  video.addEventListener('loadedmetadata', () => {
    video.play().catch(() => {/* ждём жест пользователя */});
  });

  // как только видео реально пошло — запускаем музыку и синк
  video.addEventListener('play', trySyncStart);

  // пауза видео = пауза музыки
  video.addEventListener('pause', () => { audio.pause(); stopDriftCorrection(); });

  // при перемотке корректируем смещение
  video.addEventListener('seeking', alignAudioToVideo);
  video.addEventListener('seeked',  alignAudioToVideo);
  video.addEventListener('timeupdate', alignAudioToVideo);

  // первый тач включает звук, если браузер блокирует автоплей с аудио
  window.addEventListener('pointerdown', function userUnlock() {
    audio.play().then(() => {
      fadeInAudio(1, 0.02, 100);
      startDriftCorrection();
      hint.classList.remove('show');
      window.removeEventListener('pointerdown', userUnlock, { passive: true });
    }).catch(() => {
      showHint('Разреши звук в браузере и нажми ещё раз');
    });
  }, { passive: true });

  video.addEventListener('error', () => showHint('Ошибка видео: проверь ссылку или имя файла'));
  audio.addEventListener('error', () => showHint('Ошибка аудио: проверь ссылку на mp3'));
})();
</script>

</body>
</html>
