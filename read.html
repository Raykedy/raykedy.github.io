<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Читать — 2051: Алгоритм Пробуждение</title>
<meta name="description" content="Читай книгу «2051: Алгоритм Пробуждение». Официальная страница чтения." />
<meta property="og:type" content="website" />
<meta property="og:title" content="Читать — 2051: Алгоритм Пробуждение" />
<meta property="og:description" content="Официальная страница чтения." />

<style>
  /* База */
  * { box-sizing: border-box; }
  html, body { height: 100%; margin: 0; }
  body { background:#000; color:#fff; font-family: Arial, sans-serif; }

  /* Слой видео */
  .bg { position: fixed; inset: 0; z-index: 0; overflow: hidden; background:#000; }
  .bg video {
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    min-width:100%; min-height:100%; width:auto; height:auto;
    object-fit:cover; opacity:0; transition:opacity .8s ease;
    background:#000;
  }
  .bg.is-ready video { opacity:1; }

  /* Fallback (для случаев, когда видео не стартует) */
  .bg .fallback {
    position:absolute; inset:0; display:none;
    background:#000 center/cover no-repeat;
  }
  .bg.is-fallback .fallback { display:block; }

  /* Контент поверх видео */
  .content {
    position: relative; z-index: 1; min-height: 100vh;
    display: grid; grid-template-rows: auto 1fr auto;
  }
  header, footer {
    padding: 16px;
    background: linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,0));
  }
  footer {
    background: linear-gradient(0deg, rgba(0,0,0,.55), rgba(0,0,0,0));
  }
  main {
    display: grid; place-items: center; padding: 6vh 16px;
  }
  .reader {
    width: min(900px, 92vw);
    background: rgba(0,0,0,.45);
    border: 1px solid rgba(255,255,255,.18);
    border-radius: 16px;
    backdrop-filter: blur(8px);
    padding: 20px;
  }
  .title { margin: 0 0 8px; font-size: 28px; line-height: 1.2; }
  .subtitle { margin: 0 0 16px; opacity: .9; }

  /* Кнопки управления */
  .controls {
    position: fixed; right: 14px; bottom: 14px; z-index: 2; display:flex; gap:10px;
  }
  .chip {
    padding:10px 14px; border-radius:999px;
    border:1px solid rgba(255,255,255,.18);
    background: rgba(0,0,0,.45);
    backdrop-filter: blur(8px);
    color:#fff; font-weight:600; cursor:pointer;
  }
  .chip[aria-pressed="true"] { outline: 2px solid rgba(255,255,255,.25); }

  @media (max-width: 480px) {
    .title { font-size: 22px; }
  }
</style>
</head>
<body>

<!-- ВИДЕО-ФОН -->
<div class="bg" id="bg">
  <!-- ЗАМЕНИ ссылки ниже на свои (желательно хранить в этом же репо) -->
  <video id="bgVideo" playsinline muted loop autoplay preload="auto"
         poster="assets/read-fallback.jpg"><!-- ← poster: статический кадр -->
    <source src="assets/read-bg.webm" type="video/webm" />
    <source src="assets/read-bg.mp4"  type="video/mp4" />
  </video>
  <div class="fallback" id="bgFallback"
       style="background-image:url('assets/read-fallback.jpg');"></div>
</div>

<!-- КОНТРОЛЫ -->
<div class="controls">
  <button class="chip" id="videoToggle" aria-pressed="false">Видео</button>
  <button class="chip" id="muteToggle"  aria-pressed="true">Звук выкл</button>
</div>

<!-- СОДЕРЖИМОЕ СТРАНИЦЫ ЧТЕНИЯ -->
<div class="content">
  <header>
    <strong>Официальный хаб · Читать</strong>
  </header>

  <main>
    <article class="reader">
      <h1 class="title">2051: Алгоритм Пробуждение</h1>
      <p class="subtitle">Глава 1 (демо)</p>

      <!-- Сюда поставим текст/встраивание чтения -->
      <div id="chapter">
        <p>Здесь будет текст главы / виджет чтения / ссылки на Telegram/Bastyon с доступом.</p>
        <!-- Пример ссылки на Telegram-канал: -->
        <p><a href="https://t.me/raykedy2051" target="_blank" rel="noopener">Открыть главы в Telegram</a></p>
      </div>
    </article>
  </main>

  <footer>
    © <span id="y"></span> Ray Kedy · raykedy.com
  </footer>
</div>

<script>
(function(){
  const $ = id => document.getElementById(id);
  const bg = $('bg');
  const video = $('bgVideo');
  const fallback = $('bgFallback');
  const year = $('y');
  const videoToggle = $('videoToggle');
  const muteToggle  = $('muteToggle');

  year && (year.textContent = new Date().getFullYear());

  // Показать картинку, если видео не готово быстро/ошибка
  const enableFallback = () => {
    bg.classList.add('is-fallback');
    bg.classList.remove('is-ready');
  };

  // Запуск видео (autoplay работает только с muted + playsinline)
  async function primeVideo() {
    if (!video) return enableFallback();
    try {
      // в ряде браузеров play() возвращает промис
      const p = video.play();
      if (p && typeof p.then === 'function') { await p; }
      video.addEventListener('canplay', () => bg.classList.add('is-ready'), { once:true });

      // таймаут, если буферизация затянулась (напр., Firefox)
      setTimeout(() => {
        if (!video.readyState || video.readyState < 2) enableFallback();
      }, 1200);
    } catch (e) {
      enableFallback();
    }
  }

  // Переключатель: скрыть/показать видео (оставляя фон-картинку)
  function toggleVideo(){
    const hidden = video.style.display === 'none';
    if (hidden) {
      video.style.display = '';
      videoToggle.setAttribute('aria-pressed','false');
      // пробуем снова
      if (bg.classList.contains('is-fallback')) {
        bg.classList.remove('is-fallback');
        primeVideo();
      }
    } else {
      video.style.display = 'none';
      videoToggle.setAttribute('aria-pressed','true');
    }
  }

  // Звук: по умолчанию выключен (muted=true). Если у видео есть аудиодорожка — можно включать.
  function toggleMute(){
    const willUnmute = video.muted; // если сейчас мутед, значит включим звук
    video.muted = !willUnmute;
    muteToggle.textContent = willUnmute ? 'Звук вкл' : 'Звук выкл';
    muteToggle.setAttribute('aria-pressed', String(willUnmute));
    // В некоторых браузерах после снятия mute нужно «пнуть» play():
    if (!video.paused) { video.play().catch(()=>{}); }
  }

  videoToggle && videoToggle.addEventListener('click', toggleVideo);
  muteToggle  && muteToggle.addEventListener('click', toggleMute);

  // Старт
  primeVideo();
})();
</script>
</body>
</html>
 
