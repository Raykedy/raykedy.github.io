<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–û–ø–ª–∞—Ç–∞ —É—Å–ø–µ—à–Ω–∞ ‚Äî 2051</title>
<meta name="color-scheme" content="dark light" />
<style>
  :root{
    --bg-image-url: url("./assets/bg/9f0.jpg");
    --radius: 18px;
    --shadow: 0 10px 30px rgba(0,0,0,.35);
    --brand-orange: #ff7a00;
    --brand-green:  #29e070;
    --card-max-w: 720px;
  }

  *{ box-sizing:border-box; }
  html,body{ height:100%; margin:0; font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif; line-height:1.55; }
  body{ position:relative; color:#e9eef5; background:#0a0f14; overflow-x:hidden; }

  /* –§–æ–Ω */
  body::before{
    content:""; position:fixed; inset:0;
    background-image:
      linear-gradient(rgba(5,10,15,.55), rgba(5,10,15,.75)),
      var(--bg-image-url);
    background-size:cover; background-position:center; background-attachment:fixed;
    filter:saturate(1.05) contrast(1.02);
    z-index:-2;
  }
  body::after{
    content:""; position:fixed; inset:0;
    background: radial-gradient(rgba(255,255,255,.035) 1px, transparent 1px);
    background-size:3px 3px; pointer-events:none; z-index:-1;
  }

  /* –¶–µ–Ω—Ç—Ä–æ–≤–∫–∞ –Ω–∞ Android */
  .wrap{ min-height:100svh; display:grid; place-items:center; padding:32px 16px; }
  .card{
    width:100%; max-width:var(--card-max-w);
    margin-inline:auto; background:rgba(10,14,20,.66);
    backdrop-filter:blur(8px); border:1px solid rgba(255,255,255,.08);
    border-radius:var(--radius); box-shadow:var(--shadow); overflow:clip;
  }

  .card__bar{ height:5px; background:linear-gradient(90deg,var(--brand-orange),var(--brand-green)); }
  .card__inner{ padding:24px; padding-top:20px; }

  .pill{
    display:inline-flex; align-items:center; gap:8px; padding:10px 14px;
    background:rgba(41,224,112,.12); border:1px solid rgba(41,224,112,.35);
    border-radius:999px; color:#bff7d6; font-size:14px; margin-bottom:14px;
  }
  .pill svg{ width:18px; height:18px; }

  .brand{ color:#c8d2df; font-weight:600; margin:0 0 8px 0; letter-spacing:.2px; }
  .title{ margin:0 0 8px 0; font-size:clamp(22px,2.8vw,32px); font-weight:800; }
  .subtitle{ margin:0 0 16px 0; color:#c8d2df; }

  .note{
    background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12);
    border-radius:14px; padding:12px 14px; color:#cbd6e4; margin:16px 0 18px;
    font-size:14px;
  }

  .actions{ display:flex; flex-wrap:wrap; gap:10px; }
  .btn{
    appearance:none; border:0; cursor:pointer; user-select:none;
    display:inline-flex; align-items:center; gap:10px;
    padding:14px 18px; border-radius:14px; font-weight:800; font-size:16px;
    transition:transform .06s ease, box-shadow .2s ease, opacity .2s ease; text-decoration:none;
  }
  .btn:hover{ transform:translateY(-1px); }
  .btn:disabled{ opacity:.65; cursor:not-allowed; transform:none; }

  .btn-primary{
    color:#0b0f14;
    background:linear-gradient(90deg,#ff7a00,#ffd17a);
    box-shadow:0 10px 18px rgba(255,122,0,.25);
  }
  .btn-ghost{
    color:#e9eef5; background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.14);
    font-weight:700;
  }

  .emailbox{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
  .emailbox input{
    flex:1 1 260px; min-width:220px; padding:12px 14px; border-radius:12px;
    border:1px solid rgba(255,255,255,.14); background:rgba(255,255,255,.08);
    color:#e9eef5; outline:none;
  }
  .emailbox input::placeholder{ color:#a7b8cb; }

  .footer{ text-align:center; font-size:12.5px; color:#a7b8cb; padding:16px 0 6px; }

  @media (max-width:460px){ .emailbox{ flex-direction:column; } }
</style>
</head>
<body>
  <div class="wrap">
    <article class="card" role="status" aria-live="polite">
      <div class="card__bar"></div>
      <div class="card__inner">
        <div class="pill">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <circle cx="12" cy="12" r="10" stroke="currentColor" opacity=".35"/>
            <path d="M7 12.5l3.2 3.2L17.5 8.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          –û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
        </div>

        <p class="brand">Ray Kedy ‚Ä¢ 2051</p>
        <h1 class="title">–°–ø–∞—Å–∏–±–æ! –û–ø–ª–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∞ ‚úÖ</h1>
        <p class="subtitle">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å e-–∫–Ω–∏–≥—É –Ω–∞ –≤–∞—à e-mail.</p>

        <div class="note">–ï—Å–ª–∏ –ø–∏—Å—å–º–æ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ ¬´–°–ø–∞–º¬ª.</div>

        <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å—å–º–∞ -->
        <div class="actions" style="margin-bottom:10px;">
          <button id="sendBtn" class="btn btn-primary">
            <span aria-hidden="true">üì©</span> –í—ã—Å–ª–∞—Ç—å –∫–Ω–∏–≥—É –Ω–∞ e-mail
          </button>
          <a class="btn btn-ghost" href="/">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
        </div>

        <!-- –ü–æ–ª–µ e-mail (–ø–æ–∫–∞–∂–µ—Ç—Å—è, –µ—Å–ª–∏ email –Ω–µ –ø—Ä–∏—à—ë–ª –≤ query) -->
        <div id="emailBox" class="emailbox" hidden>
          <input id="emailInput" type="email" inputmode="email" autocomplete="email" placeholder="–í–∞—à e-mail –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–Ω–∏–≥–∏">
          <button id="sendBtnInline" class="btn btn-ghost" type="button">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>

        <div class="footer">2051: –ê–ª–≥–æ—Ä–∏—Ç–º –ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ ‚Äî Ray Kedy</div>
      </div>
    </article>
  </div>

<script>
(() => {
  // === —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤–æ—Ä–∫–µ—Ä–∞ (–∫–∞–∫ –±—ã–ª —É –Ω–∞—Å —Ä–∞–Ω–µ–µ) ===
  const SEND_ENDPOINT = "/api/send-download";

  // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
  const p = new URLSearchParams(location.search);
  const orderId = p.get("orderId") || "";
  const emailQ  = p.get("email")   || "";
  const download= p.get("download")|| ""; // –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º ‚Äî –≤–æ—Ä–∫–µ—Ä —Å–∞–º –ø–æ–¥—Å—Ç–∞–≤–∏—Ç

  const sendBtn = document.getElementById("sendBtn");
  const emailBox = document.getElementById("emailBox");
  const emailInput = document.getElementById("emailInput");
  const sendBtnInline = document.getElementById("sendBtnInline");

  if (!emailQ) emailBox.hidden = false; // –µ—Å–ª–∏ email –Ω–µ –ø–µ—Ä–µ–¥–∞–ª–∏ ‚Äî —Å–ø—Ä–æ—Å–∏–º

  const isEmail = v => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);

  async function send(toEmail){
    if (!isEmail(toEmail)) { toast("–ù–µ–≤–µ—Ä–Ω—ã–π e-mail"); return; }

    setLoading(true);
    try{
      const res = await fetch(SEND_ENDPOINT, {
        method: "POST",
        headers: { "Content-Type":"application/json" },
        body: JSON.stringify({ orderId, email: toEmail, download })
      });
      if (!res.ok) throw new Error("send_failed");
      toast("–ü–∏—Å—å–º–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ ‚úî");
    } catch(e){
      console.error(e); toast("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏");
    } finally {
      setLoading(false);
    }
  }

  function setLoading(x){
    sendBtn.disabled = !!x;
    sendBtn.textContent = x ? "–û—Ç–ø—Ä–∞–≤–ª—è–µ–º‚Ä¶" : "–í—ã—Å–ª–∞—Ç—å –∫–Ω–∏–≥—É –Ω–∞ e-mail";
  }

  function toast(text){
    sendBtn.textContent = text;
    setTimeout(()=> sendBtn.textContent = "–í—ã—Å–ª–∞—Ç—å –∫–Ω–∏–≥—É –Ω–∞ e-mail", 1700);
  }

  sendBtn.addEventListener("click", () => {
    const target = emailQ || (emailInput && emailInput.value.trim());
    if (!target) { toast("–í–≤–µ–¥–∏—Ç–µ e-mail"); return; }
    send(target);
  });

  sendBtnInline.addEventListener("click", () => {
    const v = (emailInput && emailInput.value.trim()) || "";
    if (!v) { sendBtnInline.textContent = "–í–≤–µ–¥–∏—Ç–µ e-mail"; setTimeout(()=>sendBtnInline.textContent="–û—Ç–ø—Ä–∞–≤–∏—Ç—å",1200); return; }
    send(v);
  });
})();
</script>
</body>
</html>
